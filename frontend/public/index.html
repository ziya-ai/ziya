<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ziya - Code Assistant</title>
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        window.enableCodeApply = 'true';
        window.diffDisplayMode = 'pretty';
        window.diffViewType = 'unified';
    </script>
</head>
<body>
<div id="root"></div>

<!-- Initialize FormatterRegistry before plugins load -->
<script type="text/javascript">
(function() {
    class FormatterRegistry {
        constructor() {
            this.formatters = [];
        }
        
        register(formatter) {
            this.formatters.push(formatter);
            this.formatters.sort((a, b) => b.priority - a.priority);
            console.log('âœ… Registered formatter: ' + formatter.formatterId);
        }
        
        getFormatter(toolName) {
            return this.formatters.find(f => f.canFormat(toolName)) || null;
        }
        
        getAllFormatters() {
            return [...this.formatters];
        }
        
        clear() {
            this.formatters = [];
        }
    }
    
    window.FormatterRegistry = new FormatterRegistry();
})();
</script>

<!-- Inject formatter plugin scripts before React app loads -->
{% if formatter_scripts %}
    {% for formatter_script in formatter_scripts %}
    <script type="text/javascript">
    (function() {
        try {
            {{ formatter_script|safe }}
        } catch (error) {
            console.error('Failed to load formatter plugin:', error);
        }
    })();
    </script>
    {% endfor %}
{% endif %}

</body>
</html>
